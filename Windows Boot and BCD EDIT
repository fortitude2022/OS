rootkits:
  bootkits fuck with boot process
  firmkits: difficult to get rid of
  	goes deeper than even the kernel
  kernelkits: less common due to OS manufacturers hardening/virtualizing their kernels
  driver level rootkits
  generic rootkits: 

great for persistence, hard to find:
but...
hard to remove also

rootkits can get around system restore

Boot Process

POST Power On Self Test occurs on trigger
	can be manipulated by firmware
	
BIOS AND UEFI
treat as seperate
BIOS is simpler
UEFI is backwards compat

Windows 10 uses UEFI

BIOS requires
	reads MBR mastbootrec 
		512 bytes of primary HD, (always first 512)
		Boot Loader
		Partition Table
			maximum 4 partitions
			individual partitions can be partitioned further
			C drive, restore, 2 other drives meant for backups ( 1 for boot, )
	Windows Boot Manager
		(bootmgr) manages boot proc
	BCD Boot Config Data Store
	OSLoader
		winload.exe cold start
		winresume.exe for hibernation
		for ssds, fast boot has no rationale to be enabled
			for hibernations, RAM is written to hibernation.sys and saved to C drive
			true shutdown, nothing written to a file
			fast-boot: combo of both, writes what system is doing to a page file on C drive, then turns off, no user data saved
				only applies to shutdowns, NOT restarts; thats why restarts fix stuff at OS level
		ntoskernel.exe loads kernel
			

UEFI has its own organic OS, far more secure
	secureboot enabled
		pre-kernel boot: mitigates driver level rootkits before OS loads
		some anti-virus software is signed allowing it to load pre-OS
		
	Process:
	GPT:
		UEFI knows where GPT is, no 2 GPT tables ought to be in same locale (exc if master image )
	UEFI Boot manger bootmgrfw.efi
		mngs boot proc
	BCD
		2007 and before: boot.ini replaced (red flag if found)
	OS loader
		same but with .efi inst of .exe
		ntoskernel.exe
	
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	
